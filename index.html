<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Crackio Store</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <!-- NAV -->
  <nav class="navbar">
    <ul class="nav-links">
      <li><a href="#">Inicio</a></li>
      <li class="submenu">
        <a href="#productos">Productos</a>
        <ul class="dropdown">
          <li><a href="#iluminacion">Iluminación</a></li>
          <li><a href="#smart">Smart</a></li>
          <li><a href="#teclado">Teclado</a></li>
          <li><a href="#mouse">Mouse</a></li>
        </ul>
      </li>
      <li><a href="#contacto">Contacto</a></li>
    </ul>
  </nav>
<!-- ÍCONO DE CARRITO -->
<div class="carrito-icono" onclick="mostrarCarrito()">
  🛒 <span id="contador-carrito">0</span>
</div>

<!-- MODAL DEL CARRITO -->
<div id="modal-carrito" class="modal-carrito">
  <div class="modal-contenido">
    <span class="cerrar" onclick="cerrarCarrito()">&times;</span>
    <h2>Tu Carrito</h2>
    <div id="lista-carrito"></div>
    <p id="total-carrito">Total: S/ 0.00</p>
  </div>
</div>

  <!-- BANNER -->
  <div class="banner">
    <img src="images/Banner2.png" alt="Banner Crackio Store" />
  </div>

  <!-- PRODUCTOS -->
  <section class="productos" id="productos">
    <h2>Nuestros Productos</h2>
    <div id="contenedor-productos" class="contenedor-productos"></div>
  </section>

  <!-- CONTACTO -->
  <section id="contacto" class="contacto">
    <h2>Contáctanos</h2>
    <p>¿Tienes dudas? Escríbenos a nuestro WhatsApp o por redes sociales.</p>
    <p><strong>Email:</strong> contacto@crackio.com</p>
    <p><strong>WhatsApp:</strong> +51 999 999 999</p>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="redes-sociales">
      <a href="https://www.facebook.com/people/Crakcio-Store/61578344680156/?locale=es_LA" target="_blank"><i class="fab fa-facebook"></i></a>
      <a href="https://wa.me/tu-numero" target="_blank"><i class="fab fa-whatsapp"></i></a>
      <a href="https://www.instagram.com/crakciostore/" target="_blank"><i class="fab fa-instagram"></i></a>
    </div>
    <p>&copy; 2025 Crackio Store. Todos los derechos reservados.</p>
  </footer>

  <!-- SCRIPT: Productos desde Supabase -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const SUPABASE_URL = 'https://twznikjjvtoedfaxbuvf.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3em5pa2pqdnRvZWRmYXhidXZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyOTI1NDAsImV4cCI6MjA2ODg2ODU0MH0.aOQ10hq-syYqrenvFxveBQj6wKqdDtsDKfykSm42MFE';

    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    async function cargarProductos() {
      const { data: productos, error } = await supabase
        .from('productos')
        .select('*');

      if (error) {
        console.error("Error al cargar productos:", error);
        return;
      }

      const contenedor = document.getElementById("contenedor-productos");
      contenedor.innerHTML = "";

      productos.forEach((producto) => {
        const div = document.createElement("div");
        div.classList.add("producto-card");
       div.innerHTML = `
  <img class="producto-img" src="${producto.imagen_url}" alt="${producto.nombre}" />
  <h3>${producto.nombre}</h3>
  <p>${producto.descripcion}</p>
  <p class="precio">S/ ${producto.precio.toFixed(2)}</p>
  <p class="stock">${producto.stock > 0 ? `Stock: ${producto.stock}` : '<span style="color:red">Agotado</span>'}</p>
  ${producto.stock > 0 ? `<button onclick='agregarAlCarrito(${JSON.stringify(producto)})'>Agregar al carrito</button>` : ''}
`;

        contenedor.appendChild(div);
      });
    }

    cargarProductos();
  </script>
  <script>
  let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

  function agregarAlCarrito(producto) {
    const index = carrito.findIndex(p => p.id === producto.id);
    if (index > -1) {
      carrito[index].cantidad += 1;
    } else {
      carrito.push({ ...producto, cantidad: 1 });
    }
    actualizarCarrito();
  }

  function mostrarCarrito() {
    document.getElementById('modal-carrito').style.display = 'block';
    renderizarCarrito();
  }

  function cerrarCarrito() {
    document.getElementById('modal-carrito').style.display = 'none';
  }

  function eliminarDelCarrito(id) {
    carrito = carrito.filter(p => p.id !== id);
    actualizarCarrito();
  }

  function actualizarCarrito() {
    localStorage.setItem('carrito', JSON.stringify(carrito));
    document.getElementById('contador-carrito').innerText = carrito.reduce((acc, p) => acc + p.cantidad, 0);
    renderizarCarrito();
  }

  function renderizarCarrito() {
    const lista = document.getElementById('lista-carrito');
    const total = document.getElementById('total-carrito');
    lista.innerHTML = '';

    let totalPrecio = 0;
    carrito.forEach(p => {
      totalPrecio += p.precio * p.cantidad;
      const div = document.createElement('div');
      div.classList.add('item-carrito');
      div.innerHTML = `
        <p><strong>${p.nombre}</strong> (x${p.cantidad}) - S/ ${(p.precio * p.cantidad).toFixed(2)}</p>
        <button onclick="eliminarDelCarrito(${p.id})">Eliminar</button>
      `;
      lista.appendChild(div);
    });

    total.innerText = `Total: S/ ${totalPrecio.toFixed(2)}`;
  }

  // Al cargar la página
  actualizarCarrito();
</script>

</body>

</html>
